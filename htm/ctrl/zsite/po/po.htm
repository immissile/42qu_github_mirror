<%!
from model.po import CID_QUESTION
from model.po_question import answer_count
from model.state import STATE_DEL, STATE_SECRET, STATE_ACTIVE
from datetime import datetime
%>
<%inherit file="_po.htm" />
<%namespace file="/ctrl/_util/htm.htm" name="htm"/>
<%namespace file="_vote.htm" import="po_bar_vote"/>

<%def name="po_body()">
<%
po_id = po.id
cid = po.cid
zsite_url = zsite.link
%>
%if po.rid:
<h1 id="po_answer_name">${po.name_htm|n}</h1>
%else:
<h1><a href="${po.link}" class="c0">${po.name_htm|n}</a></h1>
%endif
<pre class="prebody">${po.htm|n}\
<p class="po_bar po_bar1">\
%if can_admin:
    <a class="L" href="${po.link_edit}">编辑</a>\
%endif
<a href="${zsite_url}">${zsite.name}</a>\
% if zsite_tag_id:
 : \
<a href="${zsite_url}/tag/${zsite_tag_id}">${tag_name}</a>\
% elif po.state == STATE_SECRET:
 : 私密
%endif
</p>\
${po_bar_vote(po)}\
%if cid == CID_QUESTION:
<%
count = answer_count(po.id)
%>\
<p>\
<a href="${po.link}">\
%if count:
<span class="qsnum">${count}</span>\
%endif
回答</a>
</p>\
%endif
</pre>
</%def>

