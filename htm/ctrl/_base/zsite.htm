<%!
from config import SITE_DOMAIN, SITE_URL, LOGO_TEXT
from model.notice import notice_unread as _notice_unread
from model.follow import follow_get
from model.zsite import CID_USER
%>

<%inherit file="_style_1.htm" />

<%def name="htm_title()">
%if zsite:
${zsite.name}
%else:
${SITE_DOMAIN} - ${LOGO_TEXT}
%endif
</%def>

<%def name="_h_nav_notice()">
<%
    link = current_user.link
%>\
<%
notice_unread = _notice_unread.get(current_user_id)
%>\
    %if notice_unread:
<%
if notice_unread > 99:
    notice_unread = "99+"
%>\
<div class="D">\
<a class="DA notice" href="${link}/notice">提醒<span href="${link}/notice">${notice_unread}</span></a>\
</div>\
    %endif
</%def>



<%def name="h_nav_inner()">
<%
    link = current_user.link
%>\
<div class="D">\
<a class="DA" href="javascript:void(0)">更多</a>\
<div>\
    <a href="${link}/i">资料</a>\
    <a href="${link}/money/bill">账目</a>\
    <a href="//help.${SITE_DOMAIN}">帮助</a>\
    <a href="/logout?${_xsrf}">退出</a>\
</div>\
</div>\
<div class="D">\
<a class="DA" href="javascript:void(0)">我的</a>\
<div>\
    <a href="${link}">主页</a>\
    <a href="${link}/following">关注</a>\
    <a href="${link}/wall">留言</a>\
    <a href="${link}/notice">提醒</a>\
</div>\
</div>\
<div class="D">\
<a class="DA" href="javascript:void(0)">发布</a>\
<div>\
<a href="javascript:po_photo();void(0)">图片</a>\
<a href="${link}/po/question">问题</a>\
<a href="${link}/po/note">文章</a>\
<a href="javascript:po_audio();void(0)">音乐</a>\
<a href="javascript:po_video();void(0)">视频</a>\
<a href="${link}/po/event">活动</a>\
</div>\
</div>\
</%def>



##<div class="D">\
##<a class="DA" href="javascript:void(0)">更多</a>\
##<div>\
##<a href="${link}/live">主页</a>\
##<a href="${SITE_URL}">全站</a>\
##<a href="${link}/i">账号</a>\
##</div>\
##</div>\

<%def name="h_nav_more()"></%def>

<%def name="h_nav()">
<div class="HN">\
%if current_user:
<%
    link = current_user.link
%>\
${_h_nav_notice()}\
%if zsite_id == current_user_id:
${self.h_nav_inner()}\
%else:

%if zsite_id:
<div class="D"><a class="DA" href="javascript:void(0)">交流</a>\
<div>\
    <a href="/wall">留言</a>\
    <a href="/po/question/${zsite_id}">提问</a>\
    <a href="/pay">捐赠</a>\
</div>\
</div>\


    %if not is_owner and current_user:
<div class="D"><a class="DA" id="follow_a${zsite_id}" href="javascript:follow_a(${zsite_id});void(0)">\
        %if follow_get(current_user_id, zsite_id):
淡忘\
        %else:
关注\
        %endif
</a></div>\
    %endif

%endif
%endif
%else:
    %if zsite_id:
<div class="D"><a href="/auth/login" class="DA">登录</a></div>\
<div class="D"><a href="javascript:login();void(0);" class="DA">交流</a></div>\
    %else:
<div class="D"><a href="${SITE_URL|n}/auth/login" class="DA">登录</a></div>\
<div class="D"><a href="${SITE_URL|n}/auth/reg" class="DA">注册</a></div>\
    %endif
%endif
${self.h_nav_more()}\
</div>\
</%def>

${next.body()}

<script>\
%if current_user_id:
init_user()\
%else:
init_none()\
%endif
</script>\
